<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bt.orderPlatform.dao.WaybilMasterDetailMapper" > 
<!-- Result Map-->
<resultMap id="BaseResultMap" type="com.bt.orderPlatform.model.WaybilMasterDetail" >
	<result column="id" property="id"/>
	<result column="create_time" property="create_time"/>
	<result column="create_user" property="create_user"/>
	<result column="update_time" property="update_time"/>
	<result column="update_user" property="update_user"/>
	<result column="waybill" property="waybill"/>
	<result column="from_orgnization" property="from_orgnization"/>
	<result column="to_orgnization" property="to_orgnization"/>
	<result column="status" property="status"/>
	<result column="producttype_code" property="producttype_code"/>
	<result column="producttype_name" property="producttype_name"/>
	<result column="to_phone" property="to_phone"/>
	<result column="to_contacts" property="to_contacts"/>
	<result column="to_address" property="to_address"/>
	<result column="from_address" property="from_address"/>
	<result column="from_province" property="from_province"/>
	<result column="from_city" property="from_city"/>
	<result column="from_state" property="from_state"/>
	<result column="from_street" property="from_street"/>
	<result column="order_time" property="order_time"/>
	<result column="route_status" property="route_status"/>
	<result column="total_qty" property="total_qty"/>
	<result column="total_weight" property="total_weight"/>
	<result column="total_volumn" property="total_volumn"/>
	<result column="total_amount" property="total_amount"/>
	<result column="from_contacts" property="from_contacts"/>
	<result column="order_id" property="order_id"/>
	<result column="to_province" property="to_province"/>
	<result column="to_city" property="to_city"/>
	<result column="to_state" property="to_state"/>
	<result column="to_street" property="to_street"/>
	<result column="from_phone" property="from_phone"/>
	<result column="is_auto_bill" property="is_auto_bill"/>
	<result column="payment" property="payment"/>
	<result column="express_code" property="express_code"/>
	<result column="from_num" property="from_num"/>
	<result column="to_num" property="to_num"/>
	<result column="cargo_type" property="cargo_type"/>
	<result column="memo" property="memo"/>
	<result column="submit_date" property="submit_date"/>
	<result column="submit_time" property="submit_time"/>
	<result column="customer_source" property="customer_source"/>
	<result column="customer_phone" property="customer_phone"/>
	<result column="to_phone2" property="to_phone2"/>
	<result column="customer_number" property="customer_number"/>
	<result column="mark_destination" property="mark_destination"/>
	<result column="package_code" property="package_code"/>
	<result column="package_name" property="package_name"/>
	<result column="start_date" property="start_date"/>
	<result column="to_province_code" property="to_province_code"/>
	<result column="to_city_code" property="to_city_code"/>
	<result column="to_state_code" property="to_state_code"/>
	<result column="from_province_code" property="from_province_code"/>
	<result column="from_city_code" property="from_city_code"/>
	<result column="from_state_code" property="from_state_code"/>
	<result column="from_orgnization_code" property="from_orgnization_code"/>
	<result column="express_name" property="express_name"/>
	<result column="print_code" property="print_code"/>
	<result column="sku_code" property="sku_code"/>
	<result column="sku_name" property="sku_name"/>
	<result column="qty" property="qty"/>
	<result column="weight" property="weight"/>
	<result column="volumn" property="volumn"/>
	<result column="amount" property="amount"/>
	<result column="bat_id" property="bat_id"/>
	<result column="describes" property="describes"/>
	<result column="serialnumber" property="serialnumber"/>
	<result column="remark" property="remark"/>
	<result column="flag" property="flag"/>
	<result column="view_area_address" property="view_area_address"/>
	<result column="print_time" property="print_time"/>
	<result column="amount_flag" property="amount_flag"/>
	<result column="sendcode" property="sendcode"/>
	<result column="is_docall" property="is_docall"/>
	<result column="new_source" property="new_source"/>
	<result column="cost_center" property="cost_center"/>
	<result column="pay_path" property="pay_path"/>
	<result column="insured" property="insured"/>
	<result column="store_code" property="store_code"/>
	<result column="ordinal" property="ordinal"/>
</resultMap>
       
<!-- tb_waybil_master_detail table all fields -->
<sql id="Base_Column_List" >
	 id,new_source,create_time,create_user,update_time,update_user,waybill,from_orgnization,to_orgnization,status,producttype_code,producttype_name,to_phone,to_contacts,to_address,from_address,from_province,from_city,from_state,from_street,order_time,route_status,total_qty,total_weight,total_volumn,total_amount,from_contacts,order_id,to_province,to_city,to_state,to_street,from_phone,is_auto_bill,payment,express_code,from_num,to_num,cargo_type,memo,submit_date,submit_time,customer_source,customer_phone,to_phone2,customer_number,mark_destination,package_code,package_name,start_date,to_province_code,to_city_code,to_state_code,from_province_code,from_city_code,from_state_code,from_orgnization_code,express_name,print_code,sku_code,sku_name,qty,weight,volumn,amount,bat_id,describes,serialnumber,remark,view_area_address,print_time,amount_flag,sendcode,is_docall,custid,cost_center,pay_path,insured,store_code
</sql>
<sql id="Base_Column_List1" >
	 id,create_time,create_user,update_time,update_user,waybill,from_orgnization,to_orgnization,status,producttype_code,producttype_name,to_phone,to_contacts,to_address,from_address,from_province,from_city,from_state,from_street,order_time,route_status,from_contacts,order_id,to_province,to_city,to_state,to_street,from_phone,is_auto_bill,payment,express_code,from_num,to_num,cargo_type,memo,submit_date,submit_time,customer_source,customer_phone,to_phone2,customer_number,mark_destination,package_code,package_name,start_date,to_province_code,to_city_code,to_state_code,from_province_code,from_city_code,from_state_code,from_orgnization_code,express_name,print_code,sku_code,sku_name,qty,weight,volumn,amount,bat_id,describes,serialnumber,remark,view_area_address,print_time,amount_flag,sendcode,is_docall,custid,cost_center,pay_path,insured,store_code,describes,ordinal
</sql>
   
   
<!-- 查询条件 -->
<sql id="where_Clause">
where 1=1 and flag = '2'
<trim  suffixOverrides="," >
	 	<if test="id != null and id != ''" >
	    and id =  #{id}
	</if>
	 	<if test="sendcode != null and sendcode != ''" >
	    and sendcode =  #{sendcode}
	</if>
	<if test="create_time != null" >
	    and create_time =  #{create_time}
	</if>
	 	<if test="create_user != null and create_user != ''" >
	    and create_user =  #{create_user}
	</if>
	 	<if test="new_source != null and new_source != ''" >
	    and new_source =  #{new_source}
	</if>
	<if test="update_time != null" >
	    and update_time =  #{update_time}
	</if>
	 	<if test="update_user != null and update_user != ''" >
	    and update_user =  #{update_user}
	</if>
	 	<if test="waybill != null and waybill != ''" >
	    and waybill =  #{waybill}
	</if>
	 	<if test="from_orgnization != null and from_orgnization != ''" >
	    and from_orgnization =  #{from_orgnization}
	</if>
	 	<if test="to_orgnization != null and to_orgnization != ''" >
	    and to_orgnization =  #{to_orgnization}
	</if>
	 	<if test="status != null and status != ''" >
	    and status =  #{status}
	</if>
	 	<if test="producttype_code != null and producttype_code != ''" >
	    and producttype_code =  #{producttype_code}
	</if>
	 	<if test="producttype_name != null and producttype_name != ''" >
	    and producttype_name =  #{producttype_name}
	</if>
	 	<if test="to_phone != null and to_phone != ''" >
	    and to_phone =  #{to_phone}
	</if>
	 	<if test="to_contacts != null and to_contacts != ''" >
	    and to_contacts =  #{to_contacts}
	</if>
	 	<if test="to_address != null and to_address != ''" >
	    and to_address =  #{to_address}
	</if>
	 	<if test="from_address != null and from_address != ''" >
	    and from_address =  #{from_address}
	</if>
	 	<if test="from_province != null and from_province != ''" >
	    and from_province =  #{from_province}
	</if>
	 	<if test="from_city != null and from_city != ''" >
	    and from_city =  #{from_city}
	</if>
	 	<if test="from_state != null and from_state != ''" >
	    and from_state =  #{from_state}
	</if>
	 	<if test="from_street != null and from_street != ''" >
	    and from_street =  #{from_street}
	</if>
	<if test="order_time != null" >
	    and order_time =  #{order_time}
	</if>
	 	<if test="route_status != null and route_status != ''" >
	    and route_status =  #{route_status}
	</if>
	<if test="total_qty != null" >
	    and total_qty =  #{total_qty}
	</if>
	<if test="total_weight != null" >
	    and total_weight =  #{total_weight}
	</if>
	<if test="total_volumn != null" >
	    and total_volumn =  #{total_volumn}
	</if>
	<if test="total_amount != null" >
	    and total_amount =  #{total_amount}
	</if>
	 	<if test="from_contacts != null and from_contacts != ''" >
	    and from_contacts =  #{from_contacts}
	</if>
	 	<if test="custid != null and custid != ''" >
	    and custid =  #{custid}
	</if>
	 	<if test="order_id != null and order_id != ''" >
	    and order_id =  #{order_id}
	</if>
	 	<if test="to_province != null and to_province != ''" >
	    and to_province =  #{to_province}
	</if>
	 	<if test="to_city != null and to_city != ''" >
	    and to_city =  #{to_city}
	</if>
	 	<if test="to_state != null and to_state != ''" >
	    and to_state =  #{to_state}
	</if>
	 	<if test="to_street != null and to_street != ''" >
	    and to_street =  #{to_street}
	</if>
	 	<if test="from_phone != null and from_phone != ''" >
	    and from_phone =  #{from_phone}
	</if>
	 	<if test="is_auto_bill != null and is_auto_bill != ''" >
	    and is_auto_bill =  #{is_auto_bill}
	</if>
	 	<if test="payment != null and payment != ''" >
	    and payment =  #{payment}
	</if>
	 	<if test="express_code != null and express_code != ''" >
	    and express_code =  #{express_code}
	</if>
	 	<if test="from_num != null and from_num != ''" >
	    and from_num =  #{from_num}
	</if>
	 	<if test="to_num != null and to_num != ''" >
	    and to_num =  #{to_num}
	</if>
	 	<if test="cargo_type != null and cargo_type != ''" >
	    and cargo_type =  #{cargo_type}
	</if>
	 	<if test="memo != null and memo != ''" >
	    and memo =  #{memo}
	</if>
	<if test="submit_date != null" >
	    and submit_date =  #{submit_date}
	</if>
	 	<if test="submit_time != null and submit_time != ''" >
	    and submit_time =  #{submit_time}
	</if>
	 	<if test="customer_source != null and customer_source != ''" >
	    and customer_source =  #{customer_source}
	</if>
	 	<if test="customer_phone != null and customer_phone != ''" >
	    and customer_phone =  #{customer_phone}
	</if>
	 	<if test="to_phone2 != null and to_phone2 != ''" >
	    and to_phone2 =  #{to_phone2}
	</if>
	 	<if test="customer_number != null and customer_number != ''" >
	    and customer_number =  #{customer_number}
	</if>
	 	<if test="mark_destination != null and mark_destination != ''" >
	    and mark_destination =  #{mark_destination}
	</if>
	 	<if test="package_code != null and package_code != ''" >
	    and package_code =  #{package_code}
	</if>
	 	<if test="package_name != null and package_name != ''" >
	    and package_name =  #{package_name}
	</if>
	 	<if test="start_date != null and start_date != ''" >
	    and start_date =  #{start_date}
	</if>
	 	<if test="to_province_code != null and to_province_code != ''" >
	    and to_province_code =  #{to_province_code}
	</if>
	 	<if test="to_city_code != null and to_city_code != ''" >
	    and to_city_code =  #{to_city_code}
	</if>
	 	<if test="to_state_code != null and to_state_code != ''" >
	    and to_state_code =  #{to_state_code}
	</if>
	 	<if test="from_province_code != null and from_province_code != ''" >
	    and from_province_code =  #{from_province_code}
	</if>
	 	<if test="from_city_code != null and from_city_code != ''" >
	    and from_city_code =  #{from_city_code}
	</if>
	 	<if test="from_state_code != null and from_state_code != ''" >
	    and from_state_code =  #{from_state_code}
	</if>
	 	<if test="from_orgnization_code != null and from_orgnization_code != ''" >
	    and from_orgnization_code =  #{from_orgnization_code}
	</if>
	 	<if test="express_name != null and express_name != ''" >
	    and express_name =  #{express_name}
	</if>
	 	<if test="print_code != null and print_code != ''" >
	    and print_code =  #{print_code}
	</if>
	 	<if test="sku_code != null and sku_code != ''" >
	    and sku_code =  #{sku_code}
	</if>
	 	<if test="sku_name != null and sku_name != ''" >
	    and sku_name =  #{sku_name}
	</if>
	<if test="qty != null" >
	    and qty =  #{qty}
	</if>
	<if test="weight != null" >
	    and weight =  #{weight}
	</if>
	<if test="volumn != null" >
	    and volumn =  #{volumn}
	</if>
	<if test="amount != null" >
	    and amount =  #{amount}
	</if>
	 	<if test="bat_id != null and bat_id != ''" >
	    and bat_id =  #{bat_id}
	</if>
	 	<if test="describes != null and describes != ''" >
	    and describes =  #{describes}
	</if>
	 	<if test="serialnumber != null and serialnumber != ''" >
	    and serialnumber =  #{serialnumber}
	</if>
	 	<if test="remark != null and remark != ''" >
	    and remark =  #{remark}
	</if>
	 	<if test="print_time != null and print_time != ''" >
	    and print_time =  #{print_time}
	</if>
	 	<if test="amount_flag != null and amount_flag != ''" >
	    and amount_flag =  #{amount_flag}
	</if>
	 	<if test="is_docall != null and is_docall != ''" >
	    and is_docall =  #{is_docall}
	</if>
	 	<if test="cost_center != null and cost_center != ''" >
	    and cost_center =  #{cost_center}
	</if>
	 	<if test="pay_path != null and pay_path != ''" >
	    and pay_path =  #{pay_path}
	</if>
	 	<if test="insured != null and insured != ''" >
	    and insured =  #{insured}
	</if>
	 	<if test="store_code != null and store_code != ''" >
	    and store_code =  #{store_code}
	</if>
</trim>
</sql>

<sql id="where_Clause_flag">
where 1=1 and flag = '3'
<trim  suffixOverrides="," >
	 	<if test="create_user != null and create_user != ''" >
	    and create_user =  #{create_user}
	</if>
	 	<if test="custid != null and custid != ''" >
	    and custid =  #{custid}
	</if>
	 	<if test="sendcode != null and sendcode != ''" >
	    and sendcode =  #{sendcode}
	</if>
	 	<if test="update_user != null and update_user != ''" >
	    and update_user =  #{update_user}
	</if>
	 	<if test="waybill != null and waybill != ''" >
	    and waybill =  #{waybill}
	</if>
	 	<if test="from_orgnization != null and from_orgnization != ''" >
	    and from_orgnization =  #{from_orgnization}
	</if>
	 	<if test="to_orgnization != null and to_orgnization != ''" >
	    and to_orgnization =  #{to_orgnization}
	</if>
	 	<if test="status != null and status != ''" >
	    and status =  #{status}
	</if>
	 	<if test="producttype_code != null and producttype_code != ''" >
	    and producttype_code =  #{producttype_code}
	</if>
	 	<if test="producttype_name != null and producttype_name != ''" >
	    and producttype_name =  #{producttype_name}
	</if>
	 	<if test="to_phone != null and to_phone != ''" >
	    and to_phone =  #{to_phone}
	</if>
	 	<if test="new_source != null and new_source != ''" >
	    and new_source =  #{new_source}
	</if>
	 	<if test="to_contacts != null and to_contacts != ''" >
	    and to_contacts =  #{to_contacts}
	</if>
	 	<if test="to_address != null and to_address != ''" >
	    and to_address =  #{to_address}
	</if>
	 	<if test="from_address != null and from_address != ''" >
	    and from_address =  #{from_address}
	</if>
	 	<if test="from_province != null and from_province != ''" >
	    and from_province =  #{from_province}
	</if>
	 	<if test="from_city != null and from_city != ''" >
	    and from_city =  #{from_city}
	</if>
	 	<if test="from_state != null and from_state != ''" >
	    and from_state =  #{from_state}
	</if>
	 	<if test="from_street != null and from_street != ''" >
	    and from_street =  #{from_street}
	</if>
	<if test="order_time != null" >
	    and order_time =  #{order_time}
	</if>
	 	<if test="route_status != null and route_status != ''" >
	    and route_status =  #{route_status}
	</if>
	<if test="total_qty != null" >
	    and total_qty =  #{total_qty}
	</if>
	<if test="total_weight != null" >
	    and total_weight =  #{total_weight}
	</if>
	<if test="total_volumn != null" >
	    and total_volumn =  #{total_volumn}
	</if>
	<if test="total_amount != null" >
	    and total_amount =  #{total_amount}
	</if>
	 	<if test="from_contacts != null and from_contacts != ''" >
	    and from_contacts =  #{from_contacts}
	</if>
	 	<if test="order_id != null and order_id != ''" >
	    and order_id =  #{order_id}
	</if>
	 	<if test="to_province != null and to_province != ''" >
	    and to_province =  #{to_province}
	</if>
	 	<if test="to_city != null and to_city != ''" >
	    and to_city =  #{to_city}
	</if>
	 	<if test="to_state != null and to_state != ''" >
	    and to_state =  #{to_state}
	</if>
	 	<if test="to_street != null and to_street != ''" >
	    and to_street =  #{to_street}
	</if>
	 	<if test="from_phone != null and from_phone != ''" >
	    and from_phone =  #{from_phone}
	</if>
	 	<if test="is_auto_bill != null and is_auto_bill != ''" >
	    and is_auto_bill =  #{is_auto_bill}
	</if>
	 	<if test="payment != null and payment != ''" >
	    and payment =  #{payment}
	</if>
	 	<if test="express_code != null and express_code != ''" >
	    and express_code =  #{express_code}
	</if>
	 	<if test="from_num != null and from_num != ''" >
	    and from_num =  #{from_num}
	</if>
	 	<if test="to_num != null and to_num != ''" >
	    and to_num =  #{to_num}
	</if>
	 	<if test="cargo_type != null and cargo_type != ''" >
	    and cargo_type =  #{cargo_type}
	</if>
	 	<if test="memo != null and memo != ''" >
	    and memo =  #{memo}
	</if>
	<if test="submit_date != null" >
	    and submit_date =  #{submit_date}
	</if>
	 	<if test="submit_time != null and submit_time != ''" >
	    and submit_time =  #{submit_time}
	</if>
	 	<if test="customer_source != null and customer_source != ''" >
	    and customer_source =  #{customer_source}
	</if>
	 	<if test="customer_phone != null and customer_phone != ''" >
	    and customer_phone =  #{customer_phone}
	</if>
	 	<if test="to_phone2 != null and to_phone2 != ''" >
	    and to_phone2 =  #{to_phone2}
	</if>
	 	<if test="customer_number != null and customer_number != ''" >
	    and customer_number =  #{customer_number}
	</if>
	 	<if test="mark_destination != null and mark_destination != ''" >
	    and mark_destination =  #{mark_destination}
	</if>
	 	<if test="package_code != null and package_code != ''" >
	    and package_code =  #{package_code}
	</if>
	 	<if test="package_name != null and package_name != ''" >
	    and package_name =  #{package_name}
	</if>
	 	<if test="start_date != null and start_date != ''" >
	    and start_date =  #{start_date}
	</if>
	 	<if test="to_province_code != null and to_province_code != ''" >
	    and to_province_code =  #{to_province_code}
	</if>
	 	<if test="to_city_code != null and to_city_code != ''" >
	    and to_city_code =  #{to_city_code}
	</if>
	 	<if test="to_state_code != null and to_state_code != ''" >
	    and to_state_code =  #{to_state_code}
	</if>
	 	<if test="from_province_code != null and from_province_code != ''" >
	    and from_province_code =  #{from_province_code}
	</if>
	 	<if test="from_city_code != null and from_city_code != ''" >
	    and from_city_code =  #{from_city_code}
	</if>
	 	<if test="from_state_code != null and from_state_code != ''" >
	    and from_state_code =  #{from_state_code}
	</if>
	 	<if test="from_orgnization_code != null and from_orgnization_code != ''" >
	    and from_orgnization_code =  #{from_orgnization_code}
	</if>
	 	<if test="express_name != null and express_name != ''" >
	    and express_name =  #{express_name}
	</if>
	 	<if test="print_code != null and print_code != ''" >
	    and print_code =  #{print_code}
	</if>
	 	<if test="bat_id != null and bat_id != ''" >
	    and bat_id =  #{bat_id}
	</if>
	 	<if test="describes != null and describes != ''" >
	    and describes =  #{describes}
	</if>
	 	<if test="serialnumber != null and serialnumber != ''" >
	    and serialnumber =  #{serialnumber}
	</if>
	 	<if test="print_time != null and print_time != ''" >
	    and print_time =  #{print_time}
	</if>
	 	<if test="amount_flag != null and amount_flag != ''" >
	    and amount_flag =  #{amount_flag}
	</if>
	 	<if test="is_docall != null and is_docall != ''" >
	    and is_docall =  #{is_docall}
	</if>
	<if test="cost_center != null and cost_center != ''" >
	    and cost_center =  #{cost_center}
	</if>
	 	<if test="pay_path != null and pay_path != ''" >
	    and pay_path =  #{pay_path}
	</if>
	 	<if test="insured != null and insured != ''" >
	    and insured =  #{insured}
	</if>
	 	<if test="store_code != null and store_code != ''" >
	    and store_code =  #{store_code}
	</if>
</trim>
</sql>
   

<!-- 插入运单信息临时表 -->
<insert id="insert" parameterType="com.bt.orderPlatform.model.WaybilMasterDetail" >
  insert into tb_waybil_master_detail(id,
  print_time,
  custid,
  is_docall,
  new_source,
  cost_center,
  pay_path,
  insured,
  store_code,
  sendcode,amount_flag,create_time,create_user,update_time,update_user,waybill,from_orgnization,to_orgnization,status,producttype_code,producttype_name,to_phone,to_contacts,to_address,from_address,from_province,from_city,from_state,from_street,order_time,route_status,total_qty,total_weight,total_volumn,total_amount,from_contacts,order_id,to_province,to_city,to_state,to_street,from_phone,is_auto_bill,payment,express_code,from_num,to_num,cargo_type,memo,submit_date,submit_time,customer_source,customer_phone,to_phone2,customer_number,mark_destination,package_code,package_name,start_date,to_province_code,to_city_code,to_state_code,from_province_code,from_city_code,from_state_code,from_orgnization_code,express_name,print_code,sku_code,sku_name,qty,weight,volumn,amount,bat_id,describes,remark,serialnumber,view_area_address,view_area_fromaddress,flag)
 values
 (#{id},
 #{print_time},
 #{custid},
 #{is_docall},
 #{new_source},
 #{cost_center},
 #{pay_path},
 #{insured},
 #{store_code},
 #{sendcode},#{amount_flag},#{create_time},#{create_user},#{update_time},#{update_user},#{waybill},#{from_orgnization},
 #{to_orgnization},#{status},#{producttype_code},#{producttype_name},#{to_phone},#{to_contacts},#{to_address},
 #{from_address},#{from_province},#{from_city},#{from_state},#{from_street},#{order_time},#{route_status},
 #{total_qty},#{total_weight},#{total_volumn},#{total_amount},#{from_contacts},#{order_id},
 #{to_province},#{to_city},#{to_state},#{to_street},#{from_phone},#{is_auto_bill},#{payment},
 #{express_code},#{from_num},#{to_num},#{cargo_type},#{memo},#{submit_date},#{submit_time},
 #{customer_source},#{customer_phone},#{to_phone2},#{customer_number},#{mark_destination},
 #{package_code},#{package_name},#{start_date},#{to_province_code},#{to_city_code},#{to_state_code},
 #{from_province_code},#{from_city_code},#{from_state_code},#{from_orgnization_code},#{express_name},
 #{print_code},#{sku_code},#{sku_name},#{qty},#{weight},#{volumn},#{amount},#{bat_id},#{describes},
 #{remark},#{serialnumber},#{view_area_address},#{view_area_fromaddress},#{flag})
</insert>
<insert id="insertBaoZun" parameterType="com.bt.orderPlatform.model.BaoZunWaybilMasterDetail" >
  insert into tb_waybil_master_detail(id,
  print_time,
  custid,
  is_docall,
  new_source,
  cost_center,
  pay_path,
  insured,
  store_code,
  sendcode,amount_flag,create_time,create_user,update_time,update_user,waybill,from_orgnization,to_orgnization,status,producttype_code,producttype_name,to_phone,to_contacts,to_address,from_address,from_province,from_city,from_state,from_street,order_time,route_status,total_qty,total_weight,total_volumn,total_amount,from_contacts,order_id,to_province,to_city,to_state,to_street,from_phone,is_auto_bill,payment,express_code,from_num,to_num,cargo_type,memo,submit_date,submit_time,customer_source,customer_phone,to_phone2,customer_number,mark_destination,package_code,package_name,start_date,to_province_code,to_city_code,to_state_code,from_province_code,from_city_code,from_state_code,from_orgnization_code,express_name,print_code,sku_code,sku_name,qty,weight,volumn,amount,bat_id,describes,remark,serialnumber,view_area_address,view_area_fromaddress,flag,ordinal)
 values
 (#{id},
 #{print_time},
 #{custid},
 #{is_docall},
 #{new_source},
 #{cost_center},
 #{pay_path},
 #{insured},
 #{store_code},
 #{sendcode},#{amount_flag},#{create_time},#{create_user},#{update_time},#{update_user},#{waybill},#{from_orgnization},
 #{to_orgnization},#{status},#{producttype_code},#{producttype_name},#{to_phone},#{to_contacts},#{to_address},
 #{from_address},#{from_province},#{from_city},#{from_state},#{from_street},#{order_time},#{route_status},
 #{total_qty},#{total_weight},#{total_volumn},#{total_amount},#{from_contacts},#{order_id},
 #{to_province},#{to_city},#{to_state},#{to_street},#{from_phone},#{is_auto_bill},#{payment},
 #{express_code},#{from_num},#{to_num},#{cargo_type},#{memo},#{submit_date},#{submit_time},
 #{customer_source},#{customer_phone},#{to_phone2},#{customer_number},#{mark_destination},
 #{package_code},#{package_name},#{start_date},#{to_province_code},#{to_city_code},#{to_state_code},
 #{from_province_code},#{from_city_code},#{from_state_code},#{from_orgnization_code},#{express_name},
 #{print_code},#{sku_code},#{sku_name},#{qty},#{weight},#{volumn},#{amount},#{bat_id},#{describes},
 #{remark},#{serialnumber},#{view_area_address},#{view_area_fromaddress},#{flag},#{ordinal})
</insert>
 <!-- 插入运单信息临时表 -->
<!--<insert id="insert" parameterType="java.util.List" >
  insert into tb_waybil_master_detail(id,create_time,create_user,update_time,update_user,waybill,from_orgnization,to_orgnization,status,producttype_code,producttype_name,to_phone,to_contacts,to_address,from_address,from_province,from_city,from_state,from_street,order_time,route_status,total_qty,total_weight,total_volumn,total_amount,from_contacts,order_id,to_province,to_city,to_state,to_street,from_phone,is_auto_bill,payment,express_code,from_num,to_num,cargo_type,memo,submit_date,submit_time,customer_source,customer_phone,to_phone2,customer_number,mark_destination,package_code,package_name,start_date,to_province_code,to_city_code,to_state_code,from_province_code,from_city_code,from_state_code,from_orgnization_code,express_name,print_code,sku_code,sku_name,qty,weight,volumn,amount,bat_id,describes,remark,serialnumber,view_area_address,view_area_fromaddress,flag)
 values
 <foreach collection="list" item="obj" index="index" separator="," >
 (#{obj.id},#{obj.create_time},#{obj.create_user},#{obj.update_time},#{obj.update_user},#{obj.waybill},#{obj.from_orgnization},
 #{obj.to_orgnization},#{obj.status},#{obj.producttype_code},#{obj.producttype_name},#{obj.to_phone},#{obj.to_contacts},#{obj.to_address},
 #{obj.from_address},#{obj.from_province},#{obj.from_city},#{obj.from_state},#{obj.from_street},#{obj.order_time},#{obj.route_status},
 #{obj.total_qty},#{obj.total_weight},#{obj.total_volumn},#{obj.total_amount},#{obj.from_contacts},#{obj.order_id},
 #{obj.to_province},#{obj.to_city},#{obj.to_state},#{obj.to_street},#{obj.from_phone},#{obj.is_auto_bill},#{obj.payment},
 #{obj.express_code},#{obj.from_num},#{obj.to_num},#{obj.cargo_type},#{obj.memo},#{obj.submit_date},#{obj.submit_time},
 #{obj.customer_source},#{obj.customer_phone},#{obj.to_phone2},#{obj.customer_number},#{obj.mark_destination},
 #{obj.package_code},#{obj.package_name},#{obj.start_date},#{obj.to_province_code},#{obj.to_city_code},#{obj.to_state_code},
 #{obj.from_province_code},#{obj.from_city_code},#{obj.from_state_code},#{obj.from_orgnization_code},#{obj.express_name},
 #{obj.print_code},#{obj.sku_code},#{obj.sku_name},#{obj.qty},#{obj.weight},#{obj.volumn},#{obj.amount},#{obj.bat_id},#{obj.describes},
 #{obj.remark},#{obj.serialnumber},#{obj.view_area_address},#{obj.view_area_fromaddress},#{obj.flag})
  </foreach>
</insert> -->

<!-- 修改运单信息临时表-->  
 <update id="update" parameterType="com.bt.orderPlatform.model.WaybilMasterDetail" >
  update tb_waybil_master_detail set create_time=#{create_time},
  create_user=#{create_user},
  remark=#{remark},
  print_time=#{print_time},
  amount_flag=#{amount_flag},
  custid=#{custid},
  sendcode=#{sendcode},
  is_docall=#{is_docall},
  new_source=#{new_source},
  cost_center=#{cost_center},
  pay_path=#{pay_path},
  insured=#{insured},
  store_code=#{store_code},
  update_time=#{update_time},update_user=#{update_user},waybill=#{waybill},from_orgnization=#{from_orgnization},to_orgnization=#{to_orgnization},status=#{status},producttype_code=#{producttype_code},producttype_name=#{producttype_name},to_phone=#{to_phone},to_contacts=#{to_contacts},to_address=#{to_address},from_address=#{from_address},from_province=#{from_province},from_city=#{from_city},from_state=#{from_state},from_street=#{from_street},order_time=#{order_time},route_status=#{route_status},total_qty=#{total_qty},total_weight=#{total_weight},total_volumn=#{total_volumn},total_amount=#{total_amount},from_contacts=#{from_contacts},order_id=#{order_id},to_province=#{to_province},to_city=#{to_city},to_state=#{to_state},to_street=#{to_street},from_phone=#{from_phone},is_auto_bill=#{is_auto_bill},payment=#{payment},express_code=#{express_code},from_num=#{from_num},to_num=#{to_num},cargo_type=#{cargo_type},memo=#{memo},submit_date=#{submit_date},submit_time=#{submit_time},customer_source=#{customer_source},customer_phone=#{customer_phone},to_phone2=#{to_phone2},customer_number=#{customer_number},mark_destination=#{mark_destination},package_code=#{package_code},package_name=#{package_name},start_date=#{start_date},to_province_code=#{to_province_code},to_city_code=#{to_city_code},to_state_code=#{to_state_code},from_province_code=#{from_province_code},from_city_code=#{from_city_code},from_state_code=#{from_state_code},from_orgnization_code=#{from_orgnization_code},express_name=#{express_name},print_code=#{print_code},sku_code=#{sku_code},sku_name=#{sku_name},qty=#{qty},weight=#{weight},volumn=#{volumn},amount=#{amount},bat_id=#{bat_id},describes=#{describes},serialnumber=#{serialnumber} where id=#{id}
 </update>
 
 <!-- 选择修改运单信息临时表-->
<update id="updateBySelective" parameterType="com.bt.orderPlatform.model.WaybilMasterDetail" >
	update tb_waybil_master_detail set 
	<trim  suffixOverrides="," >
	<if test="create_time != null  ">
		create_time=#{create_time},
	</if>
	<if test="sendcode != null  ">
		sendcode=#{sendcode},
	</if>
	<if test="create_user != null  and create_user != '' ">
		create_user=#{create_user},
	</if>
	<if test="custid != null  and custid != '' ">
		custid=#{custid},
	</if>
	<if test="remark != null  and remark != '' ">
		remark=#{remark},
	</if>
	<if test="update_time != null  ">
		update_time=#{update_time},
	</if>
	<if test="update_user != null  and update_user != '' ">
		update_user=#{update_user},
	</if>
	<if test="waybill != null  and waybill != '' ">
		waybill=#{waybill},
	</if>
	<if test="new_source != null  and new_source != '' ">
		new_source=#{new_source},
	</if>
	<if test="from_orgnization != null  and from_orgnization != '' ">
		from_orgnization=#{from_orgnization},
	</if>
	<if test="to_orgnization != null  and to_orgnization != '' ">
		to_orgnization=#{to_orgnization},
	</if>
	<if test="status != null  and status != '' ">
		status=#{status},
	</if>
	<if test="producttype_code != null  and producttype_code != '' ">
		producttype_code=#{producttype_code},
	</if>
	<if test="producttype_name != null  and producttype_name != '' ">
		producttype_name=#{producttype_name},
	</if>
	<if test="to_phone != null  and to_phone != '' ">
		to_phone=#{to_phone},
	</if>
	<if test="to_contacts != null  and to_contacts != '' ">
		to_contacts=#{to_contacts},
	</if>
	<if test="to_address != null  and to_address != '' ">
		to_address=#{to_address},
	</if>
	<if test="from_address != null  and from_address != '' ">
		from_address=#{from_address},
	</if>
	<if test="from_province != null  and from_province != '' ">
		from_province=#{from_province},
	</if>
	<if test="from_city != null  and from_city != '' ">
		from_city=#{from_city},
	</if>
	<if test="from_state != null  and from_state != '' ">
		from_state=#{from_state},
	</if>
	<if test="from_street != null  and from_street != '' ">
		from_street=#{from_street},
	</if>
	<if test="order_time != null  ">
		order_time=#{order_time},
	</if>
	<if test="route_status != null  and route_status != '' ">
		route_status=#{route_status},
	</if>
	<if test="total_qty != null  ">
		total_qty=#{total_qty},
	</if>
	<if test="total_weight != null  ">
		total_weight=#{total_weight},
	</if>
	<if test="total_volumn != null  ">
		total_volumn=#{total_volumn},
	</if>
	<if test="total_amount != null  ">
		total_amount=#{total_amount},
	</if>
	<if test="from_contacts != null  and from_contacts != '' ">
		from_contacts=#{from_contacts},
	</if>
	<if test="order_id != null  and order_id != '' ">
		order_id=#{order_id},
	</if>
	<if test="to_province != null  and to_province != '' ">
		to_province=#{to_province},
	</if>
	<if test="to_city != null  and to_city != '' ">
		to_city=#{to_city},
	</if>
	<if test="to_state != null  and to_state != '' ">
		to_state=#{to_state},
	</if>
	<if test="to_street != null  and to_street != '' ">
		to_street=#{to_street},
	</if>
	<if test="from_phone != null  and from_phone != '' ">
		from_phone=#{from_phone},
	</if>
	<if test="is_auto_bill != null  and is_auto_bill != '' ">
		is_auto_bill=#{is_auto_bill},
	</if>
	<if test="payment != null  and payment != '' ">
		payment=#{payment},
	</if>
	<if test="express_code != null  and express_code != '' ">
		express_code=#{express_code},
	</if>
	<if test="from_num != null  and from_num != '' ">
		from_num=#{from_num},
	</if>
	<if test="to_num != null  and to_num != '' ">
		to_num=#{to_num},
	</if>
	<if test="cargo_type != null  and cargo_type != '' ">
		cargo_type=#{cargo_type},
	</if>
	<if test="memo != null  and memo != '' ">
		memo=#{memo},
	</if>
	<if test="submit_date != null  ">
		submit_date=#{submit_date},
	</if>
	<if test="submit_time != null  and submit_time != '' ">
		submit_time=#{submit_time},
	</if>
	<if test="customer_source != null  and customer_source != '' ">
		customer_source=#{customer_source},
	</if>
	<if test="customer_phone != null  and customer_phone != '' ">
		customer_phone=#{customer_phone},
	</if>
	<if test="to_phone2 != null  and to_phone2 != '' ">
		to_phone2=#{to_phone2},
	</if>
	<if test="customer_number != null  and customer_number != '' ">
		customer_number=#{customer_number},
	</if>
	<if test="mark_destination != null  and mark_destination != '' ">
		mark_destination=#{mark_destination},
	</if>
	<if test="package_code != null  and package_code != '' ">
		package_code=#{package_code},
	</if>
	<if test="package_name != null  and package_name != '' ">
		package_name=#{package_name},
	</if>
	<if test="start_date != null  and start_date != '' ">
		start_date=#{start_date},
	</if>
	<if test="to_province_code != null  and to_province_code != '' ">
		to_province_code=#{to_province_code},
	</if>
	<if test="to_city_code != null  and to_city_code != '' ">
		to_city_code=#{to_city_code},
	</if>
	<if test="to_state_code != null  and to_state_code != '' ">
		to_state_code=#{to_state_code},
	</if>
	<if test="from_province_code != null  and from_province_code != '' ">
		from_province_code=#{from_province_code},
	</if>
	<if test="from_city_code != null  and from_city_code != '' ">
		from_city_code=#{from_city_code},
	</if>
	<if test="from_state_code != null  and from_state_code != '' ">
		from_state_code=#{from_state_code},
	</if>
	<if test="from_orgnization_code != null  and from_orgnization_code != '' ">
		from_orgnization_code=#{from_orgnization_code},
	</if>
	<if test="express_name != null  and express_name != '' ">
		express_name=#{express_name},
	</if>
	<if test="print_code != null  and print_code != '' ">
		print_code=#{print_code},
	</if>
	<if test="sku_code != null  and sku_code != '' ">
		sku_code=#{sku_code},
	</if>
	<if test="sku_name != null  and sku_name != '' ">
		sku_name=#{sku_name},
	</if>
	<if test="qty != null  ">
		qty=#{qty},
	</if>
	<if test="weight != null  ">
		weight=#{weight},
	</if>
	<if test="volumn != null  ">
		volumn=#{volumn},
	</if>
	<if test="amount != null  ">
		amount=#{amount},
	</if>
	<if test="bat_id != null  and bat_id != '' ">
		bat_id=#{bat_id},
	</if>
	<if test="describes != null  and describes != '' ">
		describes=#{describes},
	</if>
	<if test="serialnumber != null  and serialnumber != '' ">
		serialnumber=#{serialnumber},
	</if>
	<if test="print_time != null  and print_time != '' ">
		print_time=#{print_time},
	</if>
	<if test="amount_flag != null  and amount_flag != '' ">
		amount_flag=#{amount_flag},
	</if>
	<if test="is_docall != null  and is_docall != '' ">
		is_docall=#{is_docall},
	</if>
	<if test="cost_center != null  and cost_center != '' ">
		cost_center=#{cost_center},
	</if>
	<if test="pay_path != null  and pay_path != '' ">
		pay_path=#{pay_path},
	</if>
	<if test="insured != null  and insured != '' ">
		insured=#{insured},
	</if>
	<if test="store_code != null  and store_code != '' ">
		store_code=#{store_code},
	</if>
	</trim> where id=#{id}
</update>

<update id="updateByremark" parameterType="com.bt.orderPlatform.model.WaybilMasterDetail" >
	<!-- update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';快递公司不能为空') where b.bat_id=#{bat_id} and b.express_name is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';快递业务类型不能为空') where b.bat_id=#{bat_id} and b.producttype_name is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货-地址不能为空') where b.bat_id=#{bat_id} and b.to_address is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货-区不能为空') where b.bat_id=#{bat_id} and b.to_state is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货-市不能为空') where b.bat_id=#{bat_id} and b.to_city is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货-省不能为空') where b.bat_id=#{bat_id} and b.to_province is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货人电话不能为空') where b.bat_id=#{bat_id} and b.to_phone is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货人不能为空') where b.bat_id=#{bat_id} and b.to_contacts is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';货物件数不能为空') where b.bat_id=#{bat_id} and b.qty is null and b.qty = 0;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';收货城市信息不正确') where b.bat_id=#{bat_id} and b.view_area_address is null ;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set  b.flag = '2', b.remark=concat(b.remark,';发货城市信息不正确') where b.bat_id=#{bat_id} and b.view_area_fromaddress is null ;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.express_name is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.producttype_name is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.to_address is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.to_state is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.to_city is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.to_province is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.to_phone is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.to_contacts is null;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.qty is null and b.qty = 0;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.view_area_address is null ;
	update tb_waybil_master_detail b,er_expressinfo_master_inputlist a set a.flag = '2' where a.bat_id=#{bat_id} and b.view_area_fromaddress is null ; -->
	<!-- <if test="flag ='2' and flag == 2">
		update er_expressinfo_master_inputlist  set flag = '2' where bat_id=#{bat_id};	
	</if> -->
	<!-- update tb_waybil_master_detail b,tb_organization_information a set  b.from_province_code=a.org_province_code,  b.from_city_code=a.org_city_code ,b.from_state_code=a.org_state_code, b.from_street=a.org_street,b.from_address=a.org_address,b.from_province=a.org_province,b.from_city=a.org_city,b.from_state=a.org_state where b.bat_id=#{bat_id} and b.from_orgnization=a.org_name and b.from_province is null and b.from_state is null and b.from_city is null; -->
	<if test="view_area_address != null  and view_area_address != ''  ">
		update tb_waybil_master_detail b,view_area a  set  b.to_province_code = a.p_code, b.to_city_code=a.s_code,b.to_state_code=a.q_code,b.to_province=a.p_name,b.to_city=a.s_name,b.to_state=a.q_name where b.bat_id=#{bat_id} and a.address_name =b.view_area_address;
		UPDATE tb_waybil_master_detail set flag = '2' ,remark=CONCAT(remark,';收货城市信息逻辑错误') where (SELECT table1.bat_id from (SELECT b.bat_id from tb_waybil_master_detail b INNER  JOIN view_area a on a.address_name = b.view_area_address where b.bat_id=#{bat_id}) as table1 group by bat_id) is null and bat_id=#{bat_id};
		<!-- UPDATE er_expressinfo_master_inputlist set flag = '2'  where  bat_id=#{bat_id}  and   (SELECT table1.bat_id from (SELECT b.bat_id from tb_waybil_master_detail b INNER  JOIN view_area a on a.address_name = b.view_area_fromaddress where b.bat_id=#{bat_id}) as table1 group by bat_id) is null ; -->
	</if>
	<!-- <if test="view_area_address = null  and view_area_address = ''  ">
		update tb_waybil_master_detail  set flag = '2', remark=concat(remark,';收货城市信息不正确')  where bat_id=#{bat_id} ;
		update tb_waybil_master_detail b,tb_waybill_master a,er_expressinfo_master_inputlist c  set c.flag = '2' where b.bat_id=#{bat_id};
	</if>
	<if test="view_area_fromaddress = null  and view_area_fromaddress = ''  ">
		update tb_waybil_master_detail  set flag = '2', remark=concat(remark,';发货城市信息不正确')  where bat_id=#{bat_id} ;
		update er_expressinfo_master_inputlist c  set c.flag = '2' where c.bat_id=#{bat_id};
	</if> -->
	<if test="view_area_fromaddress != null  and view_area_fromaddress != ''  ">
		update tb_waybil_master_detail b,view_area a  set  b.from_province_code = a.p_code, b.from_city_code=a.s_code,b.from_state_code=a.q_code,b.from_province=a.p_name,b.from_city=a.s_name,b.from_state=a.q_name where b.bat_id=#{bat_id} and a.address_name =b.view_area_fromaddress;
		UPDATE tb_waybil_master_detail set flag = '2' ,remark=CONCAT(remark,';发货城市信息逻辑错误') where bat_id=#{bat_id}  and  (SELECT table1.bat_id from (SELECT b.bat_id from tb_waybil_master_detail b INNER  JOIN view_area a on a.address_name = b.view_area_fromaddress where b.bat_id=#{bat_id}) as table1 group by bat_id) is null;
		<!-- UPDATE er_expressinfo_master_inputlist set flag = '2'  where bat_id=#{bat_id}  and  (SELECT table1.bat_id from (SELECT b.bat_id from tb_waybil_master_detail b INNER  JOIN view_area a on a.address_name = b.view_area_fromaddress where b.bat_id=#{bat_id}) as table1 group by bat_id) is null ; -->
	</if>
	<if test="express_name != null  and express_name != '' ">
		update tb_waybil_master_detail b,tb_transport_vendor a  set  b.express_code = a.express_code where b.bat_id=#{bat_id} and a.express_name =b.express_name;
	</if>
	<if test="producttype_name != null  and producttype_name != '' and express_name != null  and express_name != '' ">
		update tb_waybil_master_detail b,tb_transport_product_type a  set  b.producttype_code = a.product_type_code where b.bat_id=#{bat_id} and a.product_type_name=b.producttype_name;
	</if>
	 <if test="customer_number != null  and customer_number != '' ">
		update tb_waybil_master_detail b,tb_waybill_master a  set  b.flag = '2', b.remark=concat(b.remark,';客户单号已存在') where b.bat_id=#{bat_id} and a.customer_number=b.customer_number;
		<!-- update er_expressinfo_master_inputlist set flag = '2' where bat_id = (SELECT a.bat_id from tb_waybil_master_detail a ,tb_waybill_master b where b.customer_number = a.customer_number and a.bat_id=#{bat_id} GROUP BY a.bat_id); -->
	</if> 
</update>
<update id="updateByBatId" parameterType="com.bt.orderPlatform.model.WaybilMasterDetail" >
	update tb_waybil_master_detail set flag = #{flag} where bat_id=#{bat_id} ;
</update>



<!-- 删除运单信息临时表 -->
<delete id="deletetByBatId" parameterType="Object">
	delete 	 from tb_waybil_master_detail where bat_id = #{bat_id}
</delete>

<!-- 删除运单信息临时表 -->
<delete id="delete" parameterType="Object">
	delete 	 from tb_waybil_master_detail where id = #{id}
</delete>
<!-- 批量删除运单信息临时表 -->
<delete id="batchDelete" parameterType="Object">
	delete 	 from tb_waybil_master_detail where id in 
	<foreach collection="array" index="index" item="item" open="(" separator="," close=")">  
       	#{item}  
   	</foreach> 
</delete>
 
<select id="selectByBatId"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List1" />,sum(amount) as total_amount, sum(volumn) as total_volumn,sum(weight) as total_weight,sum(qty) as total_qty  from tb_waybil_master_detail
	 where bat_id = #{bat_id} and customer_number is null group by 
	 express_name,
	 producttype_name,
	 payment,memo,
	 to_orgnization,
	 to_province,
	 to_city,
	 to_state,
	 to_street,
	 to_contacts,
	 to_phone,
	 to_address,
	 from_province,
	 from_city,
	 from_state,
	 from_street,
	 from_contacts,
	 from_address
</select>
<select id="baozunselectByBatId"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List1" />  from tb_waybil_master_detail
	 where bat_id = #{bat_id} 
</select>


<select id="selectByBatIdAndCustomer"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List1" />,sum(amount) as total_amount, sum(volumn) as total_volumn,sum(weight) as total_weight,sum(qty) as total_qty 
	 from tb_waybil_master_detail where bat_id = #{bat_id} and customer_number is not null group by customer_number
</select>


<select id="selectByWaybilMasterDetail"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List" />
	 from tb_waybil_master_detail where bat_id = #{bat_id} and customer_number is not null 
	 and express_name=#{express_name},
	 and producttype_name=#{producttype_name},
	 and payment=#{payment},and memo=#{memo},
	 and to_orgnization=#{to_orgnization},
	 and to_province=#{to_province},
	 and to_city=#{to_city},
	 and to_state=#{to_state},
	 and to_street=#{to_street},
	 and to_contacts=#{to_contacts},
	 and to_phone=#{to_phone},
	 and to_address=#{to_address},
	 and from_province=#{from_province},
	 and from_city=#{from_city},
	 and from_state=#{from_state},
	 and from_street=#{from_street},
	 and from_contacts=#{from_contacts},
	 and sendcode=#{sendcode},
	 and from_address=#{from_address}
</select>

<select id="selectByIdAndBatIdAndCustomer"  resultMap="BaseResultMap" >
	SELECT a.* from tb_waybil_master_detail a LEFT JOIN tb_waybil_master_detail b 
	on a.customer_number =b.customer_number WHERE a.id!=b.id and a.bat_id = #{bat_id} and b.bat_id = #{bat_id} and a.customer_number is NOT NULL 
</select>



<select id="selectByIdAndBatId"  resultMap="BaseResultMap" >
	SELECT a.* from tb_waybil_master_detail a LEFT JOIN tb_waybil_master_detail b 
	on a.bat_id = #{bat_id} and b.bat_id = #{bat_id} WHERE a.id!=b.id 
	and a.express_name=b.express_name
	 and a.producttype_name=b.producttype_name
	 and a.payment=b.payment
	and a.memo=b.memo
	 and a.to_orgnization=b.to_orgnization
	 and a.to_province=b.to_province
	 and a.to_city=b.to_city
	 and a.to_state=b.to_state
	and a.to_street=b.to_street
	and a.to_contacts=b.to_contacts
	and a.to_phone=b.to_phone
	and a.to_address=b.to_address
	and a.from_province=b.from_province
	and a.from_city=b.from_city
	and a.from_state=b.from_state
	and a.from_street=b.from_street
	and a.from_contacts=b.from_contacts
	and a.from_address=b.from_address
	and a.customer_number is  NULL 
</select>



<!-- 依据主键查找运单信息临时表 -->
<select id="selectById"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List" /> 
	 from tb_waybil_master_detail where id = #{id} 
</select>


<select id="selectBySerial_number"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List" /> 
	 from tb_waybil_master_detail where bat_id = #{bat_id}
</select>


<select id="selectByBatIdAndStuats"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List" /> 
	 from tb_waybil_master_detail where bat_id = #{bat_id} and flag='2';
</select>
  	
<select id="queryByCustomerNum"  resultMap="BaseResultMap" >
	select <include refid="Base_Column_List" /> 
	 from tb_waybil_master_detail where bat_id = #{bat_id} and customer_number = #{customer_number} 
</select>
  	
<!-- 运单信息临时表 列表总数  为分页组件使用-->
<select id="pageTotalRecord" resultType="java.lang.Long"  parameterType="com.bt.orderPlatform.controller.form.WaybilMasterDetailQueryParam">
	select count(1) from tb_waybil_master_detail 
	<include refid="where_Clause"/>
</select>
  	
  	
  	
<select id="selectWaybilMasterDetailByCustomer" resultMap="BaseResultMap" >
	select 
	<include refid="Base_Column_List"/>
	from tb_waybil_master_detail where customer_number =#{customer_number} and bat_id = #{bat_id};
</select>



<select id="selectWaybilMasterDetail" resultMap="BaseResultMap"  parameterType="com.bt.orderPlatform.model.WaybilMasterDetail">
	select 
	<include refid="Base_Column_List"/>
	from tb_waybil_master_detail 
	<include refid="where_Clause_flag"/>
</select>



<!-- 分页中的运单信息临时表集合，为分页组件使用 -->
<select id="pageData" resultMap="BaseResultMap"  parameterType="com.bt.orderPlatform.controller.form.WaybilMasterDetailQueryParam">
	select 
	<include refid="Base_Column_List"/>
	from tb_waybil_master_detail 
	<include refid="where_Clause"/>
	<if test="orderCondition != null and orderCondition != ''" >
      ${orderCondition}
    </if>
    ${queryCondition}
</select>


<select id="selectAllWaybilMasterDetail" resultMap="BaseResultMap"  parameterType="com.bt.orderPlatform.controller.form.WaybilMasterDetailQueryParam">
	select 
	<include refid="Base_Column_List"/>
	from tb_waybil_master_detail 
	<include refid="where_Clause"/>
	ORDER BY create_time DESC , ordinal ASC
	LIMIT #{firstResult }, #{maxResult }
</select>


<!--依据条件统计 运单信息临时表总数-->
<select id="countAllWaybilMasterDetail" resultType="java.lang.Integer"  parameterType="com.bt.orderPlatform.controller.form.WaybilMasterDetailQueryParam">
	select count(1) from tb_waybil_master_detail 
	<include refid="where_Clause"/>
</select>



<!--依据条件统计 运单信息临时表总数-->
<select id="count" resultType="java.lang.Long"  parameterType="com.bt.orderPlatform.controller.form.WaybilMasterDetailQueryParam">
	select count(1) from tb_waybil_master_detail 
	<include refid="where_Clause"/>
</select>
  	
<!-- 满足条件的运单信息临时表集合 -->
<select id="findAll" resultMap="BaseResultMap"  parameterType="com.bt.orderPlatform.controller.form.WaybilMasterDetailQueryParam">
	select 
	<include refid="Base_Column_List"/>
	from tb_waybil_master_detail 
	<include refid="where_Clause"/>
	<if test="orderCondition != null and orderCondition != ''" >
     ${orderCondition}
    </if>
</select>
  	
</mapper>   
